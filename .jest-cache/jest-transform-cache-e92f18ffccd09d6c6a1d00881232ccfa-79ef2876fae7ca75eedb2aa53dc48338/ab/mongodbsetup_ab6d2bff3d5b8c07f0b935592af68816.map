{"version":3,"names":["mongoose","require","MongoMemoryServer","mongod","beforeAll","create","uri","getUri","connect","useNewUrlParser","useUnifiedTopology","afterEach","connection","readyState","collections","db","collection","deleteMany","afterAll","close","stop"],"sources":["mongodb.setup.js"],"sourcesContent":["const mongoose = require('mongoose');\r\nconst { MongoMemoryServer } = require('mongodb-memory-server');\r\n\r\nlet mongod;\r\n\r\n// Connect to the in-memory database before running tests\r\nbeforeAll(async () => {\r\n  mongod = await MongoMemoryServer.create();\r\n  const uri = mongod.getUri();\r\n  await mongoose.connect(uri, {\r\n    useNewUrlParser: true,\r\n    useUnifiedTopology: true\r\n  });\r\n});\r\n\r\n// Clear all data between tests\r\nafterEach(async () => {\r\n  if (mongoose.connection.readyState !== 0) {\r\n    const collections = await mongoose.connection.db.collections();\r\n    for (let collection of collections) {\r\n      await collection.deleteMany();\r\n    }\r\n  }\r\n});\r\n\r\n// Close database connection after all tests\r\nafterAll(async () => {\r\n  if (mongoose.connection.readyState !== 0) {\r\n    await mongoose.connection.close();\r\n  }\r\n  if (mongod) {\r\n    await mongod.stop();\r\n  }\r\n}); "],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAM;EAAEC;AAAkB,CAAC,GAAGD,OAAO,CAAC,uBAAuB,CAAC;AAE9D,IAAIE,MAAM;;AAEV;AACAC,SAAS,CAAC,YAAY;EACpBD,MAAM,GAAG,MAAMD,iBAAiB,CAACG,MAAM,CAAC,CAAC;EACzC,MAAMC,GAAG,GAAGH,MAAM,CAACI,MAAM,CAAC,CAAC;EAC3B,MAAMP,QAAQ,CAACQ,OAAO,CAACF,GAAG,EAAE;IAC1BG,eAAe,EAAE,IAAI;IACrBC,kBAAkB,EAAE;EACtB,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEF;AACAC,SAAS,CAAC,YAAY;EACpB,IAAIX,QAAQ,CAACY,UAAU,CAACC,UAAU,KAAK,CAAC,EAAE;IACxC,MAAMC,WAAW,GAAG,MAAMd,QAAQ,CAACY,UAAU,CAACG,EAAE,CAACD,WAAW,CAAC,CAAC;IAC9D,KAAK,IAAIE,UAAU,IAAIF,WAAW,EAAE;MAClC,MAAME,UAAU,CAACC,UAAU,CAAC,CAAC;IAC/B;EACF;AACF,CAAC,CAAC;;AAEF;AACAC,QAAQ,CAAC,YAAY;EACnB,IAAIlB,QAAQ,CAACY,UAAU,CAACC,UAAU,KAAK,CAAC,EAAE;IACxC,MAAMb,QAAQ,CAACY,UAAU,CAACO,KAAK,CAAC,CAAC;EACnC;EACA,IAAIhB,MAAM,EAAE;IACV,MAAMA,MAAM,CAACiB,IAAI,CAAC,CAAC;EACrB;AACF,CAAC,CAAC","ignoreList":[]}