fae34ebb8fbfd7dd9ea545452a4d0ef5
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _vitest = require("vitest");
var _server = require("next/server");
var _nextAuth = require("next-auth");
var _client = require("@prisma/client");
var _route = require("@/app/api/auth/[...nextauth]/route");
var _route2 = require("@/app/api/auth/register/route");
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
// Mock next-auth
_vitest.vi.mock('next-auth', () => ({
  getServerSession: _vitest.vi.fn()
}));

// Mock Prisma
_vitest.vi.mock('@prisma/client', () => ({
  PrismaClient: _vitest.vi.fn(() => ({
    user: {
      findUnique: _vitest.vi.fn(),
      create: _vitest.vi.fn()
    },
    $transaction: _vitest.vi.fn(callback => callback())
  }))
}));
(0, _vitest.describe)('Auth API', () => {
  let mockPrisma;
  let mockSession;
  (0, _vitest.beforeEach)(() => {
    mockPrisma = new _client.PrismaClient();
    mockSession = {
      user: {
        id: 'test-user-id',
        email: 'test@example.com'
      }
    };
    _nextAuth.getServerSession.mockResolvedValue(mockSession);
  });
  (0, _vitest.afterEach)(() => {
    _vitest.vi.clearAllMocks();
  });
  (0, _vitest.describe)('GET /api/auth/session', () => {
    (0, _vitest.it)('should return session data for authenticated users', async () => {
      const request = new _server.NextRequest('http://localhost:3000/api/auth/session');
      const response = await (0, _route.GET)(request);
      const data = await response.json();
      (0, _vitest.expect)(response.status).toBe(200);
      (0, _vitest.expect)(data).toEqual(mockSession);
    });
    (0, _vitest.it)('should return null for unauthenticated users', async () => {
      ;
      _nextAuth.getServerSession.mockResolvedValue(null);
      const request = new _server.NextRequest('http://localhost:3000/api/auth/session');
      const response = await (0, _route.GET)(request);
      const data = await response.json();
      (0, _vitest.expect)(response.status).toBe(200);
      (0, _vitest.expect)(data).toBeNull();
    });
  });
  (0, _vitest.describe)('POST /api/auth/register', () => {
    (0, _vitest.it)('should create a new user account', async () => {
      const mockUser = {
        email: 'new@example.com',
        password: 'StrongPass123!',
        name: 'New User',
        role: 'PATIENT'
      };
      mockPrisma.user.findUnique.mockResolvedValue(null);
      mockPrisma.user.create.mockResolvedValue(_objectSpread({
        id: '1'
      }, mockUser));
      const request = new _server.NextRequest('http://localhost:3000/api/auth/register', {
        method: 'POST',
        body: JSON.stringify(mockUser)
      });
      const response = await (0, _route2.POST)(request);
      (0, _vitest.expect)(response.status).toBe(201);
      const data = await response.json();
      (0, _vitest.expect)(data).toHaveProperty('id');
      (0, _vitest.expect)(data.email).toBe(mockUser.email);
    });
    (0, _vitest.it)('should validate required fields', async () => {
      const request = new _server.NextRequest('http://localhost:3000/api/auth/register', {
        method: 'POST',
        body: JSON.stringify({})
      });
      const response = await (0, _route2.POST)(request);
      const data = await response.json();
      (0, _vitest.expect)(response.status).toBe(400);
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('Required fields missing'));
      (0, _vitest.expect)(data.fields).toEqual(_vitest.expect.arrayContaining(['email', 'password', 'name', 'role']));
    });
    (0, _vitest.it)('should validate password strength', async () => {
      const request = new _server.NextRequest('http://localhost:3000/api/auth/register', {
        method: 'POST',
        body: JSON.stringify({
          email: 'test@example.com',
          password: 'weak',
          name: 'Test User',
          role: 'PATIENT'
        })
      });
      const response = await (0, _route2.POST)(request);
      const data = await response.json();
      (0, _vitest.expect)(response.status).toBe(400);
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('password'));
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('Password must be at least 8 characters'));
    });
    (0, _vitest.it)('should prevent duplicate email registration', async () => {
      mockPrisma.user.findUnique.mockResolvedValue({
        id: '1',
        email: 'existing@example.com'
      });
      const request = new _server.NextRequest('http://localhost:3000/api/auth/register', {
        method: 'POST',
        body: JSON.stringify({
          email: 'existing@example.com',
          password: 'StrongPass123!',
          name: 'Test User',
          role: 'PATIENT'
        })
      });
      const response = await (0, _route2.POST)(request);
      (0, _vitest.expect)(response.status).toBe(409);
      const data = await response.json();
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('Email already exists'));
    });
    (0, _vitest.it)('should validate email format', async () => {
      const request = new _server.NextRequest('http://localhost:3000/api/auth/register', {
        method: 'POST',
        body: JSON.stringify({
          email: 'invalid-email',
          password: 'StrongPass123!',
          name: 'Test User',
          role: 'PATIENT'
        })
      });
      const response = await (0, _route2.POST)(request);
      const data = await response.json();
      (0, _vitest.expect)(response.status).toBe(400);
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('email'));
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('Invalid email format'));
    });
    (0, _vitest.it)('should validate role', async () => {
      const request = new _server.NextRequest('http://localhost:3000/api/auth/register', {
        method: 'POST',
        body: JSON.stringify({
          email: 'test@example.com',
          password: 'StrongPass123!',
          name: 'Test User',
          role: 'INVALID_ROLE'
        })
      });
      const response = await (0, _route2.POST)(request);
      const data = await response.json();
      (0, _vitest.expect)(response.status).toBe(400);
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('role'));
      (0, _vitest.expect)(data.error).toEqual(_vitest.expect.stringContaining('Invalid role. Must be one of: PATIENT, DOCTOR, STAFF'));
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdml0ZXN0IiwicmVxdWlyZSIsIl9zZXJ2ZXIiLCJfbmV4dEF1dGgiLCJfY2xpZW50IiwiX3JvdXRlIiwiX3JvdXRlMiIsIm93bktleXMiLCJlIiwiciIsInQiLCJPYmplY3QiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwibyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJkZWZhdWx0IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJkZWZpbmVQcm9wZXJ0eSIsInZpIiwibW9jayIsImdldFNlcnZlclNlc3Npb24iLCJmbiIsIlByaXNtYUNsaWVudCIsInVzZXIiLCJmaW5kVW5pcXVlIiwiY3JlYXRlIiwiJHRyYW5zYWN0aW9uIiwiY2FsbGJhY2siLCJkZXNjcmliZSIsIm1vY2tQcmlzbWEiLCJtb2NrU2Vzc2lvbiIsImJlZm9yZUVhY2giLCJpZCIsImVtYWlsIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJhZnRlckVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJyZXF1ZXN0IiwiTmV4dFJlcXVlc3QiLCJyZXNwb25zZSIsIkdFVCIsImRhdGEiLCJqc29uIiwiZXhwZWN0Iiwic3RhdHVzIiwidG9CZSIsInRvRXF1YWwiLCJ0b0JlTnVsbCIsIm1vY2tVc2VyIiwicGFzc3dvcmQiLCJuYW1lIiwicm9sZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicmVnaXN0ZXJQT1NUIiwidG9IYXZlUHJvcGVydHkiLCJlcnJvciIsInN0cmluZ0NvbnRhaW5pbmciLCJmaWVsZHMiLCJhcnJheUNvbnRhaW5pbmciXSwic291cmNlcyI6WyJhdXRoLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCwgdmkgfSBmcm9tICd2aXRlc3QnXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aCdcbmltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuaW1wb3J0IHsgR0VUIH0gZnJvbSAnQC9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZSdcbmltcG9ydCB7IFBPU1QgYXMgcmVnaXN0ZXJQT1NUIH0gZnJvbSAnQC9hcHAvYXBpL2F1dGgvcmVnaXN0ZXIvcm91dGUnXG5cbi8vIE1vY2sgbmV4dC1hdXRoXG52aS5tb2NrKCduZXh0LWF1dGgnLCAoKSA9PiAoe1xuICBnZXRTZXJ2ZXJTZXNzaW9uOiB2aS5mbigpLFxufSkpXG5cbi8vIE1vY2sgUHJpc21hXG52aS5tb2NrKCdAcHJpc21hL2NsaWVudCcsICgpID0+ICh7XG4gIFByaXNtYUNsaWVudDogdmkuZm4oKCkgPT4gKHtcbiAgICB1c2VyOiB7XG4gICAgICBmaW5kVW5pcXVlOiB2aS5mbigpLFxuICAgICAgY3JlYXRlOiB2aS5mbigpLFxuICAgIH0sXG4gICAgJHRyYW5zYWN0aW9uOiB2aS5mbihjYWxsYmFjayA9PiBjYWxsYmFjaygpKSxcbiAgfSkpLFxufSkpXG5cbmRlc2NyaWJlKCdBdXRoIEFQSScsICgpID0+IHtcbiAgbGV0IG1vY2tQcmlzbWE6IGFueVxuICBsZXQgbW9ja1Nlc3Npb246IGFueVxuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tQcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KClcbiAgICBtb2NrU2Vzc2lvbiA9IHtcbiAgICAgIHVzZXI6IHtcbiAgICAgICAgaWQ6ICd0ZXN0LXVzZXItaWQnLFxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgfSxcbiAgICB9XG4gICAgOyhnZXRTZXJ2ZXJTZXNzaW9uIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Nlc3Npb24pXG4gIH0pXG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICB2aS5jbGVhckFsbE1vY2tzKClcbiAgfSlcblxuICBkZXNjcmliZSgnR0VUIC9hcGkvYXV0aC9zZXNzaW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHNlc3Npb24gZGF0YSBmb3IgYXV0aGVudGljYXRlZCB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9zZXNzaW9uJylcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgR0VUKHJlcXVlc3QpXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKVxuICAgICAgZXhwZWN0KGRhdGEpLnRvRXF1YWwobW9ja1Nlc3Npb24pXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIG51bGwgZm9yIHVuYXV0aGVudGljYXRlZCB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIDsoZ2V0U2VydmVyU2Vzc2lvbiBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvc2Vzc2lvbicpXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEdFVChyZXF1ZXN0KVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMClcbiAgICAgIGV4cGVjdChkYXRhKS50b0JlTnVsbCgpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgnUE9TVCAvYXBpL2F1dGgvcmVnaXN0ZXInLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBuZXcgdXNlciBhY2NvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7XG4gICAgICAgIGVtYWlsOiAnbmV3QGV4YW1wbGUuY29tJyxcbiAgICAgICAgcGFzc3dvcmQ6ICdTdHJvbmdQYXNzMTIzIScsXG4gICAgICAgIG5hbWU6ICdOZXcgVXNlcicsXG4gICAgICAgIHJvbGU6ICdQQVRJRU5UJyxcbiAgICAgIH1cbiAgICAgIG1vY2tQcmlzbWEudXNlci5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpXG4gICAgICBtb2NrUHJpc21hLnVzZXIuY3JlYXRlLm1vY2tSZXNvbHZlZFZhbHVlKHsgaWQ6ICcxJywgLi4ubW9ja1VzZXIgfSlcblxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL3JlZ2lzdGVyJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobW9ja1VzZXIpLFxuICAgICAgfSlcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVnaXN0ZXJQT1NUKHJlcXVlc3QpXG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAxKVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgZXhwZWN0KGRhdGEpLnRvSGF2ZVByb3BlcnR5KCdpZCcpXG4gICAgICBleHBlY3QoZGF0YS5lbWFpbCkudG9CZShtb2NrVXNlci5lbWFpbClcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSByZXF1aXJlZCBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IE5leHRSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1dGgvcmVnaXN0ZXInLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7fSksXG4gICAgICB9KVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZWdpc3RlclBPU1QocmVxdWVzdClcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApXG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9FcXVhbChleHBlY3Quc3RyaW5nQ29udGFpbmluZygnUmVxdWlyZWQgZmllbGRzIG1pc3NpbmcnKSlcbiAgICAgIGV4cGVjdChkYXRhLmZpZWxkcykudG9FcXVhbChcbiAgICAgICAgZXhwZWN0LmFycmF5Q29udGFpbmluZyhbJ2VtYWlsJywgJ3Bhc3N3b3JkJywgJ25hbWUnLCAncm9sZSddKVxuICAgICAgKVxuICAgIH0pXG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHBhc3N3b3JkIHN0cmVuZ3RoJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL3JlZ2lzdGVyJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcGFzc3dvcmQ6ICd3ZWFrJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJyxcbiAgICAgICAgICByb2xlOiAnUEFUSUVOVCcsXG4gICAgICAgIH0pLFxuICAgICAgfSlcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVnaXN0ZXJQT1NUKHJlcXVlc3QpXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKVxuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvRXF1YWwoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ3Bhc3N3b3JkJykpXG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9FcXVhbChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzJylcbiAgICAgIClcbiAgICB9KVxuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IGR1cGxpY2F0ZSBlbWFpbCByZWdpc3RyYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrUHJpc21hLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGlkOiAnMScsIGVtYWlsOiAnZXhpc3RpbmdAZXhhbXBsZS5jb20nIH0pXG5cbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9yZWdpc3RlcicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ2V4aXN0aW5nQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBwYXNzd29yZDogJ1N0cm9uZ1Bhc3MxMjMhJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJyxcbiAgICAgICAgICByb2xlOiAnUEFUSUVOVCcsXG4gICAgICAgIH0pLFxuICAgICAgfSlcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVnaXN0ZXJQT1NUKHJlcXVlc3QpXG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDA5KVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvRXF1YWwoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0VtYWlsIGFscmVhZHkgZXhpc3RzJykpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZW1haWwgZm9ybWF0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBOZXh0UmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hdXRoL3JlZ2lzdGVyJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVtYWlsOiAnaW52YWxpZC1lbWFpbCcsXG4gICAgICAgICAgcGFzc3dvcmQ6ICdTdHJvbmdQYXNzMTIzIScsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcicsXG4gICAgICAgICAgcm9sZTogJ1BBVElFTlQnLFxuICAgICAgICB9KSxcbiAgICAgIH0pXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlZ2lzdGVyUE9TVChyZXF1ZXN0KVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMClcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0VxdWFsKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdlbWFpbCcpKVxuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IpLnRvRXF1YWwoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0ludmFsaWQgZW1haWwgZm9ybWF0JykpXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcm9sZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYXV0aC9yZWdpc3RlcicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHBhc3N3b3JkOiAnU3Ryb25nUGFzczEyMyEnLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgIHJvbGU6ICdJTlZBTElEX1JPTEUnLFxuICAgICAgICB9KSxcbiAgICAgIH0pXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlZ2lzdGVyUE9TVChyZXF1ZXN0KVxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMClcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yKS50b0VxdWFsKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdyb2xlJykpXG4gICAgICBleHBlY3QoZGF0YS5lcnJvcikudG9FcXVhbChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0ludmFsaWQgcm9sZS4gTXVzdCBiZSBvbmUgb2Y6IFBBVElFTlQsIERPQ1RPUiwgU1RBRkYnKVxuICAgICAgKVxuICAgIH0pXG4gIH0pXG59KSAiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxPQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxNQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFMLE9BQUE7QUFBb0UsU0FBQU0sUUFBQUMsQ0FBQSxFQUFBQyxDQUFBLFFBQUFDLENBQUEsR0FBQUMsTUFBQSxDQUFBQyxJQUFBLENBQUFKLENBQUEsT0FBQUcsTUFBQSxDQUFBRSxxQkFBQSxRQUFBQyxDQUFBLEdBQUFILE1BQUEsQ0FBQUUscUJBQUEsQ0FBQUwsQ0FBQSxHQUFBQyxDQUFBLEtBQUFLLENBQUEsR0FBQUEsQ0FBQSxDQUFBQyxNQUFBLFdBQUFOLENBQUEsV0FBQUUsTUFBQSxDQUFBSyx3QkFBQSxDQUFBUixDQUFBLEVBQUFDLENB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