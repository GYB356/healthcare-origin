{"version":3,"names":["events_1","require","utils","tslib_1","__importStar","debug_1","__importDefault","path","fs_1","async_mutex_1","errors_1","log","default","RepeatError","Error","constructor","repeat","LockFileStatus","exports","LockFileEvents","LockFileEventsClass","EventEmitter","LockFile","lock","file","ensureAsync","useFile","resolve","trim","assertion","length","status","checkLock","lockedDifferent","lockedSelf","waitForLock","available","createLock","UnknownLockfileStatusError","uuid","pathExists","fileData","promises","readFile","toString","split","readout","parseInt","process","pid","files","has","isNullOrUndefined","availableInstance","isAlive","err","errorWithCode","code","interval","undefined","eventCB","Promise","res","unlockedFile","setInterval","lockStatus","events","on","unlock","clearInterval","removeListener","uuidv4","mutex","runExclusive","mkdir","dirname","writeFile","add","emit","unlockCleanup","UnableToUnlockLockfileError","fileio","unlink","catch","reason","delete","Set","Mutex"],"sources":["../../src/util/lockfile.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}