{"version":3,"names":["events_1","require","utils","tslib_1","__importStar","debug_1","__importDefault","path","fs_1","async_mutex_1","uuid_1","errors_1","log","default","RepeatError","Error","constructor","repeat","LockFileStatus","exports","LockFileEvents","LockFileEventsClass","EventEmitter","LockFile","file","uuid","lock","ensureAsync","useFile","resolve","trim","assertion","length","status","checkLock","lockedDifferent","lockedSelf","waitForLock","available","createLock","UnknownLockfileStatusError","pathExists","fileData","promises","readFile","toString","split","readout","parseInt","process","pid","files","has","isNullOrUndefined","availableInstance","isAlive","err","errorWithCode","code","interval","undefined","eventCB","Promise","res","unlockedFile","setInterval","__awaiter","lockStatus","events","on","unlock","clearInterval","removeListener","v4","mutex","runExclusive","mkdir","dirname","writeFile","add","emit","_a","unlockCleanup","UnableToUnlockLockfileError","fileio","unlink","catch","reason","delete","Set","Mutex"],"sources":["../../src/util/lockfile.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}