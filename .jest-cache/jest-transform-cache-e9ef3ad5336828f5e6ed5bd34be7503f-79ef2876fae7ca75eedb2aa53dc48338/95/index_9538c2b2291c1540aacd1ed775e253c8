2f63ce15bc3b8736bd50d7bf00623c3e
/*!
 * express
 * Copyright(c) 2009-2013 TJ Holowaychuk
 * Copyright(c) 2013 Roman Shtylman
 * Copyright(c) 2014-2015 Douglas Christopher Wilson
 * MIT Licensed
 */

'use strict';

/**
 * Module dependencies.
 * @private
 */
var Route = require('./route');
var Layer = require('./layer');
var methods = require('methods');
var mixin = require('utils-merge');
var debug = require('debug')('express:router');
var deprecate = require('depd')('express');
var flatten = require('array-flatten');
var parseUrl = require('parseurl');
var setPrototypeOf = require('setprototypeof');

/**
 * Module variables.
 * @private
 */

var objectRegExp = /^\[object (\S+)\]$/;
var slice = Array.prototype.slice;
var toString = Object.prototype.toString;

/**
 * Initialize a new `Router` with the given `options`.
 *
 * @param {Object} [options]
 * @return {Router} which is a callable function
 * @public
 */

var proto = module.exports = function (options) {
  var opts = options || {};
  function router(req, res, next) {
    router.handle(req, res, next);
  }

  // mixin Router class functions
  setPrototypeOf(router, proto);
  router.params = {};
  router._params = [];
  router.caseSensitive = opts.caseSensitive;
  router.mergeParams = opts.mergeParams;
  router.strict = opts.strict;
  router.stack = [];
  return router;
};

/**
 * Map the given param placeholder `name`(s) to the given callback.
 *
 * Parameter mapping is used to provide pre-conditions to routes
 * which use normalized placeholders. For example a _:user_id_ parameter
 * could automatically load a user's information from the database without
 * any additional code,
 *
 * The callback uses the same signature as middleware, the only difference
 * being that the value of the placeholder is passed, in this case the _id_
 * of the user. Once the `next()` function is invoked, just like middleware
 * it will continue on to execute the route, or subsequent parameter functions.
 *
 * Just like in middleware, you must either respond to the request or call next
 * to avoid stalling the request.
 *
 *  app.param('user_id', function(req, res, next, id){
 *    User.find(id, function(err, user){
 *      if (err) {
 *        return next(err);
 *      } else if (!user) {
 *        return next(new Error('failed to load user'));
 *      }
 *      req.user = user;
 *      next();
 *    });
 *  });
 *
 * @param {String} name
 * @param {Function} fn
 * @return {app} for chaining
 * @public
 */

proto.param = function param(name, fn) {
  // param logic
  if (typeof name === 'function') {
    deprecate('router.param(fn): Refactor to use path params');
    this._params.push(name);
    return;
  }

  // apply param functions
  var params = this._params;
  var len = params.length;
  var ret;
  if (name[0] === ':') {
    deprecate('router.param(' + JSON.stringify(name) + ', fn): Use router.param(' + JSON.stringify(name.slice(1)) + ', fn) instead');
    name = name.slice(1);
  }
  for (var i = 0; i < len; ++i) {
    if (ret = params[i](name, fn)) {
      fn = ret;
    }
  }

  // ensure we end up with a
  // middleware function
  if ('function' !== typeof fn) {
    throw new Error('invalid param() call for ' + name + ', got ' + fn);
  }
  (this.params[name] = this.params[name] || []).push(fn);
  return this;
};

/**
 * Dispatch a req, res into the router.
 * @private
 */

proto.handle = function handle(req, res, out) {
  var self = this;
  debug('dispatching %s %s', req.method, req.url);
  var idx = 0;
  var protohost = getProtohost(req.url) || '';
  var removed = '';
  var slashAdded = false;
  var sync = 0;
  var paramcalled = {};

  // store options for OPTIONS request
  // only used if OPTIONS request
  var options = [];

  // middleware and routes
  var stack = self.stack;

  // manage inter-router variables
  var parentParams = req.params;
  var parentUrl = req.baseUrl || '';
  var done = restore(out, req, 'baseUrl', 'next', 'params');

  // setup next layer
  req.next = next;

  // for options requests, respond with a default if nothing else responds
  if (req.method === 'OPTIONS') {
    done = wrap(done, function (old, err) {
      if (err || options.length === 0) return old(err);
      sendOptionsResponse(res, options, old);
    });
  }

  // setup basic req values
  req.baseUrl = parentUrl;
  req.originalUrl = req.originalUrl || req.url;
  next();
  function next(err) {
    var layerError = err === 'route' ? null : err;

    // remove added slash
    if (slashAdded) {
      req.url = req.url.slice(1);
      slashAdded = false;
    }

    // restore altered req.url
    if (removed.length !== 0) {
      req.baseUrl = parentUrl;
      req.url = protohost + removed + req.url.slice(protohost.length);
      removed = '';
    }

    // signal to exit router
    if (layerError === 'router') {
      setImmediate(done, null);
      return;
    }

    // no more matching layers
    if (idx >= stack.length) {
      setImmediate(done, layerError);
      return;
    }

    // max sync stack
    if (++sync > 100) {
      return setImmediate(next, err);
    }

    // get pathname of request
    var path = getPathname(req);
    if (path == null) {
      return done(layerError);
    }

    // find next matching layer
    var layer;
    var match;
    var route;
    while (match !== true && idx < stack.length) {
      layer = stack[idx++];
      match = matchLayer(layer, path);
      route = layer.route;
      if (typeof match !== 'boolean') {
        // hold on to layerError
        layerError = layerError || match;
      }
      if (match !== true) {
        continue;
      }
      if (!route) {
        // process non-route handlers normally
        continue;
      }
      if (layerError) {
        // routes do not match with a pending error
        match = false;
        continue;
      }
      var method = req.method;
      var has_method = route._handles_method(method);

      // build up automatic options response
      if (!has_method && method === 'OPTIONS') {
        appendMethods(options, route._options());
      }

      // don't even bother matching route
      if (!has_method && method !== 'HEAD') {
        match = false;
      }
    }

    // no match
    if (match !== true) {
      return done(layerError);
    }

    // store route for dispatch on change
    if (route) {
      req.route = route;
    }

    // Capture one-time layer values
    req.params = self.mergeParams ? mergeParams(layer.params, parentParams) : layer.params;
    var layerPath = layer.path;

    // this should be done for the layer
    self.process_params(layer, paramcalled, req, res, function (err) {
      if (err) {
        next(layerError || err);
      } else if (route) {
        layer.handle_request(req, res, next);
      } else {
        trim_prefix(layer, layerError, layerPath, path);
      }
      sync = 0;
    });
  }
  function trim_prefix(layer, layerError, layerPath, path) {
    if (layerPath.length !== 0) {
      // Validate path is a prefix match
      if (layerPath !== path.slice(0, layerPath.length)) {
        next(layerError);
        return;
      }

      // Validate path breaks on a path separator
      var c = path[layerPath.length];
      if (c && c !== '/' && c !== '.') return next(layerError);

      // Trim off the part of the url that matches the route
      // middleware (.use stuff) needs to have the path stripped
      debug('trim prefix (%s) from url %s', layerPath, req.url);
      removed = layerPath;
      req.url = protohost + req.url.slice(protohost.length + removed.length);

      // Ensure leading slash
      if (!protohost && req.url[0] !== '/') {
        req.url = '/' + req.url;
        slashAdded = true;
      }

      // Setup base URL (no trailing slash)
      req.baseUrl = parentUrl + (removed[removed.length - 1] === '/' ? removed.substring(0, removed.length - 1) : removed);
    }
    debug('%s %s : %s', layer.name, layerPath, req.originalUrl);
    if (layerError) {
      layer.handle_error(layerError, req, res, next);
    } else {
      layer.handle_request(req, res, next);
    }
  }
};

/**
 * Process any parameters for the layer.
 * @private
 */

proto.process_params = function process_params(layer, called, req, res, done) {
  var params = this.params;

  // captured parameters from the layer, keys and values
  var keys = layer.keys;

  // fast track
  if (!keys || keys.length === 0) {
    return done();
  }
  var i = 0;
  var name;
  var paramIndex = 0;
  var key;
  var paramVal;
  var paramCallbacks;
  var paramCalled;

  // process params in order
  // param callbacks can be async
  function param(err) {
    if (err) {
      return done(err);
    }
    if (i >= keys.length) {
      return done();
    }
    paramIndex = 0;
    key = keys[i++];
    name = key.name;
    paramVal = req.params[name];
    paramCallbacks = params[name];
    paramCalled = called[name];
    if (paramVal === undefined || !paramCallbacks) {
      return param();
    }

    // param previously called with same value or error occurred
    if (paramCalled && (paramCalled.match === paramVal || paramCalled.error && paramCalled.error !== 'route')) {
      // restore value
      req.params[name] = paramCalled.value;

      // next param
      return param(paramCalled.error);
    }
    called[name] = paramCalled = {
      error: null,
      match: paramVal,
      value: paramVal
    };
    paramCallback();
  }

  // single param callbacks
  function paramCallback(err) {
    var fn = paramCallbacks[paramIndex++];

    // store updated value
    paramCalled.value = req.params[key.name];
    if (err) {
      // store error
      paramCalled.error = err;
      param(err);
      return;
    }
    if (!fn) return param();
    try {
      fn(req, res, paramCallback, paramVal, key.name);
    } catch (e) {
      paramCallback(e);
    }
  }
  param();
};

/**
 * Use the given middleware function, with optional path, defaulting to "/".
 *
 * Use (like `.all`) will run for any http METHOD, but it will not add
 * handlers for those methods so OPTIONS requests will not consider `.use`
 * functions even if they could respond.
 *
 * The other difference is that _route_ path is stripped and not visible
 * to the handler function. The main effect of this feature is that mounted
 * handlers can operate without any code changes regardless of the "prefix"
 * pathname.
 *
 * @public
 */

proto.use = function use(fn) {
  var offset = 0;
  var path = '/';

  // default path to '/'
  // disambiguate router.use([fn])
  if (typeof fn !== 'function') {
    var arg = fn;
    while (Array.isArray(arg) && arg.length !== 0) {
      arg = arg[0];
    }

    // first arg is the path
    if (typeof arg !== 'function') {
      offset = 1;
      path = fn;
    }
  }
  var callbacks = flatten(slice.call(arguments, offset));
  if (callbacks.length === 0) {
    throw new TypeError('Router.use() requires a middleware function');
  }
  for (var i = 0; i < callbacks.length; i++) {
    var fn = callbacks[i];
    if (typeof fn !== 'function') {
      throw new TypeError('Router.use() requires a middleware function but got a ' + gettype(fn));
    }

    // add the middleware
    debug('use %o %s', path, fn.name || '<anonymous>');
    var layer = new Layer(path, {
      sensitive: this.caseSensitive,
      strict: false,
      end: false
    }, fn);
    layer.route = undefined;
    this.stack.push(layer);
  }
  return this;
};

/**
 * Create a new Route for the given path.
 *
 * Each route contains a separate middleware stack and VERB handlers.
 *
 * See the Route api documentation for details on adding handlers
 * and middleware to routes.
 *
 * @param {String} path
 * @return {Route}
 * @public
 */

proto.route = function route(path) {
  var route = new Route(path);
  var layer = new Layer(path, {
    sensitive: this.caseSensitive,
    strict: this.strict,
    end: true
  }, route.dispatch.bind(route));
  layer.route = route;
  this.stack.push(layer);
  return route;
};

// create Router#VERB functions
methods.concat('all').forEach(function (method) {
  proto[method] = function (path) {
    var route = this.route(path);
    route[method].apply(route, slice.call(arguments, 1));
    return this;
  };
});

// append methods to a list of methods
function appendMethods(list, addition) {
  for (var i = 0; i < addition.length; i++) {
    var method = addition[i];
    if (list.indexOf(method) === -1) {
      list.push(method);
    }
  }
}

// get pathname of request
function getPathname(req) {
  try {
    return parseUrl(req).pathname;
  } catch (err) {
    return undefined;
  }
}

// Get get protocol + host for a URL
function getProtohost(url) {
  if (typeof url !== 'string' || url.length === 0 || url[0] === '/') {
    return undefined;
  }
  var searchIndex = url.indexOf('?');
  var pathLength = searchIndex !== -1 ? searchIndex : url.length;
  var fqdnIndex = url.slice(0, pathLength).indexOf('://');
  return fqdnIndex !== -1 ? url.substring(0, url.indexOf('/', 3 + fqdnIndex)) : undefined;
}

// get type for error message
function gettype(obj) {
  var type = typeof obj;
  if (type !== 'object') {
    return type;
  }

  // inspect [[Class]] for objects
  return toString.call(obj).replace(objectRegExp, '$1');
}

/**
 * Match path to a layer.
 *
 * @param {Layer} layer
 * @param {string} path
 * @private
 */

function matchLayer(layer, path) {
  try {
    return layer.match(path);
  } catch (err) {
    return err;
  }
}

// merge params with parent params
function mergeParams(params, parent) {
  if (typeof parent !== 'object' || !parent) {
    return params;
  }

  // make copy of parent for base
  var obj = mixin({}, parent);

  // simple non-numeric merging
  if (!(0 in params) || !(0 in parent)) {
    return mixin(obj, params);
  }
  var i = 0;
  var o = 0;

  // determine numeric gaps
  while (i in params) {
    i++;
  }
  while (o in parent) {
    o++;
  }

  // offset numeric indices in params before merge
  for (i--; i >= 0; i--) {
    params[i + o] = params[i];

    // create holes for the merge when necessary
    if (i < o) {
      delete params[i];
    }
  }
  return mixin(obj, params);
}

// restore obj props after function
function restore(fn, obj) {
  var props = new Array(arguments.length - 2);
  var vals = new Array(arguments.length - 2);
  for (var i = 0; i < props.length; i++) {
    props[i] = arguments[i + 2];
    vals[i] = obj[props[i]];
  }
  return function () {
    // restore vals
    for (var i = 0; i < props.length; i++) {
      obj[props[i]] = vals[i];
    }
    return fn.apply(this, arguments);
  };
}

// send an OPTIONS response
function sendOptionsResponse(res, options, next) {
  try {
    var body = options.join(',');
    res.set('Allow', body);
    res.send(body);
  } catch (err) {
    next(err);
  }
}

// wrap a function
function wrap(old, fn) {
  return function proxy() {
    var args = new Array(arguments.length + 1);
    args[0] = old;
    for (var i = 0, len = arguments.length; i < len; i++) {
      args[i + 1] = arguments[i];
    }
    fn.apply(this, args);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSb3V0ZSIsInJlcXVpcmUiLCJMYXllciIsIm1ldGhvZHMiLCJtaXhpbiIsImRlYnVnIiwiZGVwcmVjYXRlIiwiZmxhdHRlbiIsInBhcnNlVXJsIiwic2V0UHJvdG90eXBlT2YiLCJvYmplY3RSZWdFeHAiLCJzbGljZSIsIkFycmF5IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJPYmplY3QiLCJwcm90byIsIm1vZHVsZSIsImV4cG9ydHMiLCJvcHRpb25zIiwib3B0cyIsInJvdXRlciIsInJlcSIsInJlcyIsIm5leHQiLCJoYW5kbGUiLCJwYXJhbXMiLCJfcGFyYW1zIiwiY2FzZVNlbnNpdGl2ZSIsIm1lcmdlUGFyYW1zIiwic3RyaWN0Iiwic3RhY2siLCJwYXJhbSIsIm5hbWUiLCJmbiIsInB1c2giLCJsZW4iLCJsZW5ndGgiLCJyZXQiLCJKU09OIiwic3RyaW5naWZ5IiwiaSIsIkVycm9yIiwib3V0Iiwic2VsZiIsIm1ldGhvZCIsInVybCIsImlkeCIsInByb3RvaG9zdCIsImdldFByb3RvaG9zdCIsInJlbW92ZWQiLCJzbGFzaEFkZGVkIiwic3luYyIsInBhcmFtY2FsbGVkIiwicGFyZW50UGFyYW1zIiwicGFyZW50VXJsIiwiYmFzZVVybCIsImRvbmUiLCJyZXN0b3JlIiwid3JhcCIsIm9sZCIsImVyciIsInNlbmRPcHRpb25zUmVzcG9uc2UiLCJvcmlnaW5hbFVybCIsImxheWVyRXJyb3IiLCJzZXRJbW1lZGlhdGUiLCJwYXRoIiwiZ2V0UGF0aG5hbWUiLCJsYXllciIsIm1hdGNoIiwicm91dGUiLCJtYXRjaExheWVyIiwiaGFzX21ldGhvZCIsIl9oYW5kbGVzX21ldGhvZCIsImFwcGVuZE1ldGhvZHMiLCJfb3B0aW9ucyIsImxheWVyUGF0aCIsInByb2Nlc3NfcGFyYW1zIiwiaGFuZGxlX3JlcXVlc3QiLCJ0cmltX3ByZWZpeCIsImMiLCJzdWJzdHJpbmciLCJoYW5kbGVfZXJyb3IiLCJjYWxsZWQiLCJrZXlzIiwicGFyYW1JbmRleCIsImtleSIsInBhcmFtVmFsIiwicGFyYW1DYWxsYmFja3MiLCJwYXJhbUNhbGxlZCIsInVuZGVmaW5lZCIsImVycm9yIiwidmFsdWUiLCJwYXJhbUNhbGxiYWNrIiwiZSIsInVzZSIsIm9mZnNldCIsImFyZyIsImlzQXJyYXkiLCJjYWxsYmFja3MiLCJjYWxsIiwiYXJndW1lbnRzIiwiVHlwZUVycm9yIiwiZ2V0dHlwZSIsInNlbnNpdGl2ZSIsImVuZCIsImRpc3BhdGNoIiwiYmluZCIsImNvbmNhdCIsImZvckVhY2giLCJhcHBseSIsImxpc3QiLCJhZGRpdGlvbiIsImluZGV4T2YiLCJwYXRobmFtZSIsInNlYXJjaEluZGV4IiwicGF0aExlbmd0aCIsImZxZG5JbmRleCIsIm9iaiIsInR5cGUiLCJyZXBsYWNlIiwicGFyZW50IiwibyIsInByb3BzIiwidmFscyIsImJvZHkiLCJqb2luIiwic2V0Iiwic2VuZCIsInByb3h5IiwiYXJncyJdLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogZXhwcmVzc1xuICogQ29weXJpZ2h0KGMpIDIwMDktMjAxMyBUSiBIb2xvd2F5Y2h1a1xuICogQ29weXJpZ2h0KGMpIDIwMTMgUm9tYW4gU2h0eWxtYW5cbiAqIENvcHlyaWdodChjKSAyMDE0LTIwMTUgRG91Z2xhcyBDaHJpc3RvcGhlciBXaWxzb25cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICogQHByaXZhdGVcbiAqL1xuXG52YXIgUm91dGUgPSByZXF1aXJlKCcuL3JvdXRlJyk7XG52YXIgTGF5ZXIgPSByZXF1aXJlKCcuL2xheWVyJyk7XG52YXIgbWV0aG9kcyA9IHJlcXVpcmUoJ21ldGhvZHMnKTtcbnZhciBtaXhpbiA9IHJlcXVpcmUoJ3V0aWxzLW1lcmdlJyk7XG52YXIgZGVidWcgPSByZXF1aXJlKCdkZWJ1ZycpKCdleHByZXNzOnJvdXRlcicpO1xudmFyIGRlcHJlY2F0ZSA9IHJlcXVpcmUoJ2RlcGQnKSgnZXhwcmVzcycpO1xudmFyIGZsYXR0ZW4gPSByZXF1aXJlKCdhcnJheS1mbGF0dGVuJyk7XG52YXIgcGFyc2VVcmwgPSByZXF1aXJlKCdwYXJzZXVybCcpO1xudmFyIHNldFByb3RvdHlwZU9mID0gcmVxdWlyZSgnc2V0cHJvdG90eXBlb2YnKVxuXG4vKipcbiAqIE1vZHVsZSB2YXJpYWJsZXMuXG4gKiBAcHJpdmF0ZVxuICovXG5cbnZhciBvYmplY3RSZWdFeHAgPSAvXlxcW29iamVjdCAoXFxTKylcXF0kLztcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBhIG5ldyBgUm91dGVyYCB3aXRoIHRoZSBnaXZlbiBgb3B0aW9uc2AuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxuICogQHJldHVybiB7Um91dGVyfSB3aGljaCBpcyBhIGNhbGxhYmxlIGZ1bmN0aW9uXG4gKiBAcHVibGljXG4gKi9cblxudmFyIHByb3RvID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gIHZhciBvcHRzID0gb3B0aW9ucyB8fCB7fTtcblxuICBmdW5jdGlvbiByb3V0ZXIocmVxLCByZXMsIG5leHQpIHtcbiAgICByb3V0ZXIuaGFuZGxlKHJlcSwgcmVzLCBuZXh0KTtcbiAgfVxuXG4gIC8vIG1peGluIFJvdXRlciBjbGFzcyBmdW5jdGlvbnNcbiAgc2V0UHJvdG90eXBlT2Yocm91dGVyLCBwcm90bylcblxuICByb3V0ZXIucGFyYW1zID0ge307XG4gIHJvdXRlci5fcGFyYW1zID0gW107XG4gIHJvdXRlci5jYXNlU2Vuc2l0aXZlID0gb3B0cy5jYXNlU2Vuc2l0aXZlO1xuICByb3V0ZXIubWVyZ2VQYXJhbXMgPSBvcHRzLm1lcmdlUGFyYW1zO1xuICByb3V0ZXIuc3RyaWN0ID0gb3B0cy5zdHJpY3Q7XG4gIHJvdXRlci5zdGFjayA9IFtdO1xuXG4gIHJldHVybiByb3V0ZXI7XG59O1xuXG4vKipcbiAqIE1hcCB0aGUgZ2l2ZW4gcGFyYW0gcGxhY2Vob2xkZXIgYG5hbWVgKHMpIHRvIHRoZSBnaXZlbiBjYWxsYmFjay5cbiAqXG4gKiBQYXJhbWV0ZXIgbWFwcGluZyBpcyB1c2VkIHRvIHByb3ZpZGUgcHJlLWNvbmRpdGlvbnMgdG8gcm91dGVzXG4gKiB3aGljaCB1c2Ugbm9ybWFsaXplZCBwbGFjZWhvbGRlcnMuIEZvciBleGFtcGxlIGEgXzp1c2VyX2lkXyBwYXJhbWV0ZXJcbiAqIGNvdWxkIGF1dG9tYXRpY2FsbHkgbG9hZCBhIHVzZXIncyBpbmZvcm1hdGlvbiBmcm9tIHRoZSBkYXRhYmFzZSB3aXRob3V0XG4gKiBhbnkgYWRkaXRpb25hbCBjb2RlLFxuICpcbiAqIFRoZSBjYWxsYmFjayB1c2VzIHRoZSBzYW1lIHNpZ25hdHVyZSBhcyBtaWRkbGV3YXJlLCB0aGUgb25seSBkaWZmZXJlbmNlXG4gKiBiZWluZyB0aGF0IHRoZSB2YWx1ZSBvZiB0aGUgcGxhY2Vob2xkZXIgaXMgcGFzc2VkLCBpbiB0aGlzIGNhc2UgdGhlIF9pZF9cbiAqIG9mIHRoZSB1c2VyLiBPbmNlIHRoZSBgbmV4dCgpYCBmdW5jdGlvbiBpcyBpbnZva2VkLCBqdXN0IGxpa2UgbWlkZGxld2FyZVxuICogaXQgd2lsbCBjb250aW51ZSBvbiB0byBleGVjdXRlIHRoZSByb3V0ZSwgb3Igc3Vic2VxdWVudCBwYXJhbWV0ZXIgZnVuY3Rpb25zLlxuICpcbiAqIEp1c3QgbGlrZSBpbiBtaWRkbGV3YXJlLCB5b3UgbXVzdCBlaXRoZXIgcmVzcG9uZCB0byB0aGUgcmVxdWVzdCBvciBjYWxsIG5leHRcbiAqIHRvIGF2b2lkIHN0YWxsaW5nIHRoZSByZXF1ZXN0LlxuICpcbiAqICBhcHAucGFyYW0oJ3VzZXJfaWQnLCBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCwgaWQpe1xuICogICAgVXNlci5maW5kKGlkLCBmdW5jdGlvbihlcnIsIHVzZXIpe1xuICogICAgICBpZiAoZXJyKSB7XG4gKiAgICAgICAgcmV0dXJuIG5leHQoZXJyKTtcbiAqICAgICAgfSBlbHNlIGlmICghdXNlcikge1xuICogICAgICAgIHJldHVybiBuZXh0KG5ldyBFcnJvcignZmFpbGVkIHRvIGxvYWQgdXNlcicpKTtcbiAqICAgICAgfVxuICogICAgICByZXEudXNlciA9IHVzZXI7XG4gKiAgICAgIG5leHQoKTtcbiAqICAgIH0pO1xuICogIH0pO1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHJldHVybiB7YXBwfSBmb3IgY2hhaW5pbmdcbiAqIEBwdWJsaWNcbiAqL1xuXG5wcm90by5wYXJhbSA9IGZ1bmN0aW9uIHBhcmFtKG5hbWUsIGZuKSB7XG4gIC8vIHBhcmFtIGxvZ2ljXG4gIGlmICh0eXBlb2YgbmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGRlcHJlY2F0ZSgncm91dGVyLnBhcmFtKGZuKTogUmVmYWN0b3IgdG8gdXNlIHBhdGggcGFyYW1zJyk7XG4gICAgdGhpcy5fcGFyYW1zLnB1c2gobmFtZSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gYXBwbHkgcGFyYW0gZnVuY3Rpb25zXG4gIHZhciBwYXJhbXMgPSB0aGlzLl9wYXJhbXM7XG4gIHZhciBsZW4gPSBwYXJhbXMubGVuZ3RoO1xuICB2YXIgcmV0O1xuXG4gIGlmIChuYW1lWzBdID09PSAnOicpIHtcbiAgICBkZXByZWNhdGUoJ3JvdXRlci5wYXJhbSgnICsgSlNPTi5zdHJpbmdpZnkobmFtZSkgKyAnLCBmbik6IFVzZSByb3V0ZXIucGFyYW0oJyArIEpTT04uc3RyaW5naWZ5KG5hbWUuc2xpY2UoMSkpICsgJywgZm4pIGluc3RlYWQnKVxuICAgIG5hbWUgPSBuYW1lLnNsaWNlKDEpXG4gIH1cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKHJldCA9IHBhcmFtc1tpXShuYW1lLCBmbikpIHtcbiAgICAgIGZuID0gcmV0O1xuICAgIH1cbiAgfVxuXG4gIC8vIGVuc3VyZSB3ZSBlbmQgdXAgd2l0aCBhXG4gIC8vIG1pZGRsZXdhcmUgZnVuY3Rpb25cbiAgaWYgKCdmdW5jdGlvbicgIT09IHR5cGVvZiBmbikge1xuICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBwYXJhbSgpIGNhbGwgZm9yICcgKyBuYW1lICsgJywgZ290ICcgKyBmbik7XG4gIH1cblxuICAodGhpcy5wYXJhbXNbbmFtZV0gPSB0aGlzLnBhcmFtc1tuYW1lXSB8fCBbXSkucHVzaChmbik7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcSwgcmVzIGludG8gdGhlIHJvdXRlci5cbiAqIEBwcml2YXRlXG4gKi9cblxucHJvdG8uaGFuZGxlID0gZnVuY3Rpb24gaGFuZGxlKHJlcSwgcmVzLCBvdXQpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gIGRlYnVnKCdkaXNwYXRjaGluZyAlcyAlcycsIHJlcS5tZXRob2QsIHJlcS51cmwpO1xuXG4gIHZhciBpZHggPSAwO1xuICB2YXIgcHJvdG9ob3N0ID0gZ2V0UHJvdG9ob3N0KHJlcS51cmwpIHx8ICcnXG4gIHZhciByZW1vdmVkID0gJyc7XG4gIHZhciBzbGFzaEFkZGVkID0gZmFsc2U7XG4gIHZhciBzeW5jID0gMFxuICB2YXIgcGFyYW1jYWxsZWQgPSB7fTtcblxuICAvLyBzdG9yZSBvcHRpb25zIGZvciBPUFRJT05TIHJlcXVlc3RcbiAgLy8gb25seSB1c2VkIGlmIE9QVElPTlMgcmVxdWVzdFxuICB2YXIgb3B0aW9ucyA9IFtdO1xuXG4gIC8vIG1pZGRsZXdhcmUgYW5kIHJvdXRlc1xuICB2YXIgc3RhY2sgPSBzZWxmLnN0YWNrO1xuXG4gIC8vIG1hbmFnZSBpbnRlci1yb3V0ZXIgdmFyaWFibGVzXG4gIHZhciBwYXJlbnRQYXJhbXMgPSByZXEucGFyYW1zO1xuICB2YXIgcGFyZW50VXJsID0gcmVxLmJhc2VVcmwgfHwgJyc7XG4gIHZhciBkb25lID0gcmVzdG9yZShvdXQsIHJlcSwgJ2Jhc2VVcmwnLCAnbmV4dCcsICdwYXJhbXMnKTtcblxuICAvLyBzZXR1cCBuZXh0IGxheWVyXG4gIHJlcS5uZXh0ID0gbmV4dDtcblxuICAvLyBmb3Igb3B0aW9ucyByZXF1ZXN0cywgcmVzcG9uZCB3aXRoIGEgZGVmYXVsdCBpZiBub3RoaW5nIGVsc2UgcmVzcG9uZHNcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdPUFRJT05TJykge1xuICAgIGRvbmUgPSB3cmFwKGRvbmUsIGZ1bmN0aW9uKG9sZCwgZXJyKSB7XG4gICAgICBpZiAoZXJyIHx8IG9wdGlvbnMubGVuZ3RoID09PSAwKSByZXR1cm4gb2xkKGVycik7XG4gICAgICBzZW5kT3B0aW9uc1Jlc3BvbnNlKHJlcywgb3B0aW9ucywgb2xkKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIHNldHVwIGJhc2ljIHJlcSB2YWx1ZXNcbiAgcmVxLmJhc2VVcmwgPSBwYXJlbnRVcmw7XG4gIHJlcS5vcmlnaW5hbFVybCA9IHJlcS5vcmlnaW5hbFVybCB8fCByZXEudXJsO1xuXG4gIG5leHQoKTtcblxuICBmdW5jdGlvbiBuZXh0KGVycikge1xuICAgIHZhciBsYXllckVycm9yID0gZXJyID09PSAncm91dGUnXG4gICAgICA/IG51bGxcbiAgICAgIDogZXJyO1xuXG4gICAgLy8gcmVtb3ZlIGFkZGVkIHNsYXNoXG4gICAgaWYgKHNsYXNoQWRkZWQpIHtcbiAgICAgIHJlcS51cmwgPSByZXEudXJsLnNsaWNlKDEpXG4gICAgICBzbGFzaEFkZGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gcmVzdG9yZSBhbHRlcmVkIHJlcS51cmxcbiAgICBpZiAocmVtb3ZlZC5sZW5ndGggIT09IDApIHtcbiAgICAgIHJlcS5iYXNlVXJsID0gcGFyZW50VXJsO1xuICAgICAgcmVxLnVybCA9IHByb3RvaG9zdCArIHJlbW92ZWQgKyByZXEudXJsLnNsaWNlKHByb3RvaG9zdC5sZW5ndGgpXG4gICAgICByZW1vdmVkID0gJyc7XG4gICAgfVxuXG4gICAgLy8gc2lnbmFsIHRvIGV4aXQgcm91dGVyXG4gICAgaWYgKGxheWVyRXJyb3IgPT09ICdyb3V0ZXInKSB7XG4gICAgICBzZXRJbW1lZGlhdGUoZG9uZSwgbnVsbClcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIG5vIG1vcmUgbWF0Y2hpbmcgbGF5ZXJzXG4gICAgaWYgKGlkeCA+PSBzdGFjay5sZW5ndGgpIHtcbiAgICAgIHNldEltbWVkaWF0ZShkb25lLCBsYXllckVycm9yKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBtYXggc3luYyBzdGFja1xuICAgIGlmICgrK3N5bmMgPiAxMDApIHtcbiAgICAgIHJldHVybiBzZXRJbW1lZGlhdGUobmV4dCwgZXJyKVxuICAgIH1cblxuICAgIC8vIGdldCBwYXRobmFtZSBvZiByZXF1ZXN0XG4gICAgdmFyIHBhdGggPSBnZXRQYXRobmFtZShyZXEpO1xuXG4gICAgaWYgKHBhdGggPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGRvbmUobGF5ZXJFcnJvcik7XG4gICAgfVxuXG4gICAgLy8gZmluZCBuZXh0IG1hdGNoaW5nIGxheWVyXG4gICAgdmFyIGxheWVyO1xuICAgIHZhciBtYXRjaDtcbiAgICB2YXIgcm91dGU7XG5cbiAgICB3aGlsZSAobWF0Y2ggIT09IHRydWUgJiYgaWR4IDwgc3RhY2subGVuZ3RoKSB7XG4gICAgICBsYXllciA9IHN0YWNrW2lkeCsrXTtcbiAgICAgIG1hdGNoID0gbWF0Y2hMYXllcihsYXllciwgcGF0aCk7XG4gICAgICByb3V0ZSA9IGxheWVyLnJvdXRlO1xuXG4gICAgICBpZiAodHlwZW9mIG1hdGNoICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgLy8gaG9sZCBvbiB0byBsYXllckVycm9yXG4gICAgICAgIGxheWVyRXJyb3IgPSBsYXllckVycm9yIHx8IG1hdGNoO1xuICAgICAgfVxuXG4gICAgICBpZiAobWF0Y2ggIT09IHRydWUpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmICghcm91dGUpIHtcbiAgICAgICAgLy8gcHJvY2VzcyBub24tcm91dGUgaGFuZGxlcnMgbm9ybWFsbHlcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChsYXllckVycm9yKSB7XG4gICAgICAgIC8vIHJvdXRlcyBkbyBub3QgbWF0Y2ggd2l0aCBhIHBlbmRpbmcgZXJyb3JcbiAgICAgICAgbWF0Y2ggPSBmYWxzZTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBtZXRob2QgPSByZXEubWV0aG9kO1xuICAgICAgdmFyIGhhc19tZXRob2QgPSByb3V0ZS5faGFuZGxlc19tZXRob2QobWV0aG9kKTtcblxuICAgICAgLy8gYnVpbGQgdXAgYXV0b21hdGljIG9wdGlvbnMgcmVzcG9uc2VcbiAgICAgIGlmICghaGFzX21ldGhvZCAmJiBtZXRob2QgPT09ICdPUFRJT05TJykge1xuICAgICAgICBhcHBlbmRNZXRob2RzKG9wdGlvbnMsIHJvdXRlLl9vcHRpb25zKCkpO1xuICAgICAgfVxuXG4gICAgICAvLyBkb24ndCBldmVuIGJvdGhlciBtYXRjaGluZyByb3V0ZVxuICAgICAgaWYgKCFoYXNfbWV0aG9kICYmIG1ldGhvZCAhPT0gJ0hFQUQnKSB7XG4gICAgICAgIG1hdGNoID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gbm8gbWF0Y2hcbiAgICBpZiAobWF0Y2ggIT09IHRydWUpIHtcbiAgICAgIHJldHVybiBkb25lKGxheWVyRXJyb3IpO1xuICAgIH1cblxuICAgIC8vIHN0b3JlIHJvdXRlIGZvciBkaXNwYXRjaCBvbiBjaGFuZ2VcbiAgICBpZiAocm91dGUpIHtcbiAgICAgIHJlcS5yb3V0ZSA9IHJvdXRlO1xuICAgIH1cblxuICAgIC8vIENhcHR1cmUgb25lLXRpbWUgbGF5ZXIgdmFsdWVzXG4gICAgcmVxLnBhcmFtcyA9IHNlbGYubWVyZ2VQYXJhbXNcbiAgICAgID8gbWVyZ2VQYXJhbXMobGF5ZXIucGFyYW1zLCBwYXJlbnRQYXJhbXMpXG4gICAgICA6IGxheWVyLnBhcmFtcztcbiAgICB2YXIgbGF5ZXJQYXRoID0gbGF5ZXIucGF0aDtcblxuICAgIC8vIHRoaXMgc2hvdWxkIGJlIGRvbmUgZm9yIHRoZSBsYXllclxuICAgIHNlbGYucHJvY2Vzc19wYXJhbXMobGF5ZXIsIHBhcmFtY2FsbGVkLCByZXEsIHJlcywgZnVuY3Rpb24gKGVycikge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBuZXh0KGxheWVyRXJyb3IgfHwgZXJyKVxuICAgICAgfSBlbHNlIGlmIChyb3V0ZSkge1xuICAgICAgICBsYXllci5oYW5kbGVfcmVxdWVzdChyZXEsIHJlcywgbmV4dClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyaW1fcHJlZml4KGxheWVyLCBsYXllckVycm9yLCBsYXllclBhdGgsIHBhdGgpXG4gICAgICB9XG5cbiAgICAgIHN5bmMgPSAwXG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiB0cmltX3ByZWZpeChsYXllciwgbGF5ZXJFcnJvciwgbGF5ZXJQYXRoLCBwYXRoKSB7XG4gICAgaWYgKGxheWVyUGF0aC5sZW5ndGggIT09IDApIHtcbiAgICAgIC8vIFZhbGlkYXRlIHBhdGggaXMgYSBwcmVmaXggbWF0Y2hcbiAgICAgIGlmIChsYXllclBhdGggIT09IHBhdGguc2xpY2UoMCwgbGF5ZXJQYXRoLmxlbmd0aCkpIHtcbiAgICAgICAgbmV4dChsYXllckVycm9yKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgcGF0aCBicmVha3Mgb24gYSBwYXRoIHNlcGFyYXRvclxuICAgICAgdmFyIGMgPSBwYXRoW2xheWVyUGF0aC5sZW5ndGhdXG4gICAgICBpZiAoYyAmJiBjICE9PSAnLycgJiYgYyAhPT0gJy4nKSByZXR1cm4gbmV4dChsYXllckVycm9yKVxuXG4gICAgICAvLyBUcmltIG9mZiB0aGUgcGFydCBvZiB0aGUgdXJsIHRoYXQgbWF0Y2hlcyB0aGUgcm91dGVcbiAgICAgIC8vIG1pZGRsZXdhcmUgKC51c2Ugc3R1ZmYpIG5lZWRzIHRvIGhhdmUgdGhlIHBhdGggc3RyaXBwZWRcbiAgICAgIGRlYnVnKCd0cmltIHByZWZpeCAoJXMpIGZyb20gdXJsICVzJywgbGF5ZXJQYXRoLCByZXEudXJsKTtcbiAgICAgIHJlbW92ZWQgPSBsYXllclBhdGg7XG4gICAgICByZXEudXJsID0gcHJvdG9ob3N0ICsgcmVxLnVybC5zbGljZShwcm90b2hvc3QubGVuZ3RoICsgcmVtb3ZlZC5sZW5ndGgpXG5cbiAgICAgIC8vIEVuc3VyZSBsZWFkaW5nIHNsYXNoXG4gICAgICBpZiAoIXByb3RvaG9zdCAmJiByZXEudXJsWzBdICE9PSAnLycpIHtcbiAgICAgICAgcmVxLnVybCA9ICcvJyArIHJlcS51cmw7XG4gICAgICAgIHNsYXNoQWRkZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXR1cCBiYXNlIFVSTCAobm8gdHJhaWxpbmcgc2xhc2gpXG4gICAgICByZXEuYmFzZVVybCA9IHBhcmVudFVybCArIChyZW1vdmVkW3JlbW92ZWQubGVuZ3RoIC0gMV0gPT09ICcvJ1xuICAgICAgICA/IHJlbW92ZWQuc3Vic3RyaW5nKDAsIHJlbW92ZWQubGVuZ3RoIC0gMSlcbiAgICAgICAgOiByZW1vdmVkKTtcbiAgICB9XG5cbiAgICBkZWJ1ZygnJXMgJXMgOiAlcycsIGxheWVyLm5hbWUsIGxheWVyUGF0aCwgcmVxLm9yaWdpbmFsVXJsKTtcblxuICAgIGlmIChsYXllckVycm9yKSB7XG4gICAgICBsYXllci5oYW5kbGVfZXJyb3IobGF5ZXJFcnJvciwgcmVxLCByZXMsIG5leHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsYXllci5oYW5kbGVfcmVxdWVzdChyZXEsIHJlcywgbmV4dCk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYW55IHBhcmFtZXRlcnMgZm9yIHRoZSBsYXllci5cbiAqIEBwcml2YXRlXG4gKi9cblxucHJvdG8ucHJvY2Vzc19wYXJhbXMgPSBmdW5jdGlvbiBwcm9jZXNzX3BhcmFtcyhsYXllciwgY2FsbGVkLCByZXEsIHJlcywgZG9uZSkge1xuICB2YXIgcGFyYW1zID0gdGhpcy5wYXJhbXM7XG5cbiAgLy8gY2FwdHVyZWQgcGFyYW1ldGVycyBmcm9tIHRoZSBsYXllciwga2V5cyBhbmQgdmFsdWVzXG4gIHZhciBrZXlzID0gbGF5ZXIua2V5cztcblxuICAvLyBmYXN0IHRyYWNrXG4gIGlmICgha2V5cyB8fCBrZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBkb25lKCk7XG4gIH1cblxuICB2YXIgaSA9IDA7XG4gIHZhciBuYW1lO1xuICB2YXIgcGFyYW1JbmRleCA9IDA7XG4gIHZhciBrZXk7XG4gIHZhciBwYXJhbVZhbDtcbiAgdmFyIHBhcmFtQ2FsbGJhY2tzO1xuICB2YXIgcGFyYW1DYWxsZWQ7XG5cbiAgLy8gcHJvY2VzcyBwYXJhbXMgaW4gb3JkZXJcbiAgLy8gcGFyYW0gY2FsbGJhY2tzIGNhbiBiZSBhc3luY1xuICBmdW5jdGlvbiBwYXJhbShlcnIpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICByZXR1cm4gZG9uZShlcnIpO1xuICAgIH1cblxuICAgIGlmIChpID49IGtleXMubGVuZ3RoICkge1xuICAgICAgcmV0dXJuIGRvbmUoKTtcbiAgICB9XG5cbiAgICBwYXJhbUluZGV4ID0gMDtcbiAgICBrZXkgPSBrZXlzW2krK107XG4gICAgbmFtZSA9IGtleS5uYW1lO1xuICAgIHBhcmFtVmFsID0gcmVxLnBhcmFtc1tuYW1lXTtcbiAgICBwYXJhbUNhbGxiYWNrcyA9IHBhcmFtc1tuYW1lXTtcbiAgICBwYXJhbUNhbGxlZCA9IGNhbGxlZFtuYW1lXTtcblxuICAgIGlmIChwYXJhbVZhbCA9PT0gdW5kZWZpbmVkIHx8ICFwYXJhbUNhbGxiYWNrcykge1xuICAgICAgcmV0dXJuIHBhcmFtKCk7XG4gICAgfVxuXG4gICAgLy8gcGFyYW0gcHJldmlvdXNseSBjYWxsZWQgd2l0aCBzYW1lIHZhbHVlIG9yIGVycm9yIG9jY3VycmVkXG4gICAgaWYgKHBhcmFtQ2FsbGVkICYmIChwYXJhbUNhbGxlZC5tYXRjaCA9PT0gcGFyYW1WYWxcbiAgICAgIHx8IChwYXJhbUNhbGxlZC5lcnJvciAmJiBwYXJhbUNhbGxlZC5lcnJvciAhPT0gJ3JvdXRlJykpKSB7XG4gICAgICAvLyByZXN0b3JlIHZhbHVlXG4gICAgICByZXEucGFyYW1zW25hbWVdID0gcGFyYW1DYWxsZWQudmFsdWU7XG5cbiAgICAgIC8vIG5leHQgcGFyYW1cbiAgICAgIHJldHVybiBwYXJhbShwYXJhbUNhbGxlZC5lcnJvcik7XG4gICAgfVxuXG4gICAgY2FsbGVkW25hbWVdID0gcGFyYW1DYWxsZWQgPSB7XG4gICAgICBlcnJvcjogbnVsbCxcbiAgICAgIG1hdGNoOiBwYXJhbVZhbCxcbiAgICAgIHZhbHVlOiBwYXJhbVZhbFxuICAgIH07XG5cbiAgICBwYXJhbUNhbGxiYWNrKCk7XG4gIH1cblxuICAvLyBzaW5nbGUgcGFyYW0gY2FsbGJhY2tzXG4gIGZ1bmN0aW9uIHBhcmFtQ2FsbGJhY2soZXJyKSB7XG4gICAgdmFyIGZuID0gcGFyYW1DYWxsYmFja3NbcGFyYW1JbmRleCsrXTtcblxuICAgIC8vIHN0b3JlIHVwZGF0ZWQgdmFsdWVcbiAgICBwYXJhbUNhbGxlZC52YWx1ZSA9IHJlcS5wYXJhbXNba2V5Lm5hbWVdO1xuXG4gICAgaWYgKGVycikge1xuICAgICAgLy8gc3RvcmUgZXJyb3JcbiAgICAgIHBhcmFtQ2FsbGVkLmVycm9yID0gZXJyO1xuICAgICAgcGFyYW0oZXJyKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWZuKSByZXR1cm4gcGFyYW0oKTtcblxuICAgIHRyeSB7XG4gICAgICBmbihyZXEsIHJlcywgcGFyYW1DYWxsYmFjaywgcGFyYW1WYWwsIGtleS5uYW1lKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBwYXJhbUNhbGxiYWNrKGUpO1xuICAgIH1cbiAgfVxuXG4gIHBhcmFtKCk7XG59O1xuXG4vKipcbiAqIFVzZSB0aGUgZ2l2ZW4gbWlkZGxld2FyZSBmdW5jdGlvbiwgd2l0aCBvcHRpb25hbCBwYXRoLCBkZWZhdWx0aW5nIHRvIFwiL1wiLlxuICpcbiAqIFVzZSAobGlrZSBgLmFsbGApIHdpbGwgcnVuIGZvciBhbnkgaHR0cCBNRVRIT0QsIGJ1dCBpdCB3aWxsIG5vdCBhZGRcbiAqIGhhbmRsZXJzIGZvciB0aG9zZSBtZXRob2RzIHNvIE9QVElPTlMgcmVxdWVzdHMgd2lsbCBub3QgY29uc2lkZXIgYC51c2VgXG4gKiBmdW5jdGlvbnMgZXZlbiBpZiB0aGV5IGNvdWxkIHJlc3BvbmQuXG4gKlxuICogVGhlIG90aGVyIGRpZmZlcmVuY2UgaXMgdGhhdCBfcm91dGVfIHBhdGggaXMgc3RyaXBwZWQgYW5kIG5vdCB2aXNpYmxlXG4gKiB0byB0aGUgaGFuZGxlciBmdW5jdGlvbi4gVGhlIG1haW4gZWZmZWN0IG9mIHRoaXMgZmVhdHVyZSBpcyB0aGF0IG1vdW50ZWRcbiAqIGhhbmRsZXJzIGNhbiBvcGVyYXRlIHdpdGhvdXQgYW55IGNvZGUgY2hhbmdlcyByZWdhcmRsZXNzIG9mIHRoZSBcInByZWZpeFwiXG4gKiBwYXRobmFtZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cblxucHJvdG8udXNlID0gZnVuY3Rpb24gdXNlKGZuKSB7XG4gIHZhciBvZmZzZXQgPSAwO1xuICB2YXIgcGF0aCA9ICcvJztcblxuICAvLyBkZWZhdWx0IHBhdGggdG8gJy8nXG4gIC8vIGRpc2FtYmlndWF0ZSByb3V0ZXIudXNlKFtmbl0pXG4gIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICB2YXIgYXJnID0gZm47XG5cbiAgICB3aGlsZSAoQXJyYXkuaXNBcnJheShhcmcpICYmIGFyZy5sZW5ndGggIT09IDApIHtcbiAgICAgIGFyZyA9IGFyZ1swXTtcbiAgICB9XG5cbiAgICAvLyBmaXJzdCBhcmcgaXMgdGhlIHBhdGhcbiAgICBpZiAodHlwZW9mIGFyZyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgb2Zmc2V0ID0gMTtcbiAgICAgIHBhdGggPSBmbjtcbiAgICB9XG4gIH1cblxuICB2YXIgY2FsbGJhY2tzID0gZmxhdHRlbihzbGljZS5jYWxsKGFyZ3VtZW50cywgb2Zmc2V0KSk7XG5cbiAgaWYgKGNhbGxiYWNrcy5sZW5ndGggPT09IDApIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSb3V0ZXIudXNlKCkgcmVxdWlyZXMgYSBtaWRkbGV3YXJlIGZ1bmN0aW9uJylcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGZuID0gY2FsbGJhY2tzW2ldO1xuXG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUm91dGVyLnVzZSgpIHJlcXVpcmVzIGEgbWlkZGxld2FyZSBmdW5jdGlvbiBidXQgZ290IGEgJyArIGdldHR5cGUoZm4pKVxuICAgIH1cblxuICAgIC8vIGFkZCB0aGUgbWlkZGxld2FyZVxuICAgIGRlYnVnKCd1c2UgJW8gJXMnLCBwYXRoLCBmbi5uYW1lIHx8ICc8YW5vbnltb3VzPicpXG5cbiAgICB2YXIgbGF5ZXIgPSBuZXcgTGF5ZXIocGF0aCwge1xuICAgICAgc2Vuc2l0aXZlOiB0aGlzLmNhc2VTZW5zaXRpdmUsXG4gICAgICBzdHJpY3Q6IGZhbHNlLFxuICAgICAgZW5kOiBmYWxzZVxuICAgIH0sIGZuKTtcblxuICAgIGxheWVyLnJvdXRlID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5zdGFjay5wdXNoKGxheWVyKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgUm91dGUgZm9yIHRoZSBnaXZlbiBwYXRoLlxuICpcbiAqIEVhY2ggcm91dGUgY29udGFpbnMgYSBzZXBhcmF0ZSBtaWRkbGV3YXJlIHN0YWNrIGFuZCBWRVJCIGhhbmRsZXJzLlxuICpcbiAqIFNlZSB0aGUgUm91dGUgYXBpIGRvY3VtZW50YXRpb24gZm9yIGRldGFpbHMgb24gYWRkaW5nIGhhbmRsZXJzXG4gKiBhbmQgbWlkZGxld2FyZSB0byByb3V0ZXMuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHBhdGhcbiAqIEByZXR1cm4ge1JvdXRlfVxuICogQHB1YmxpY1xuICovXG5cbnByb3RvLnJvdXRlID0gZnVuY3Rpb24gcm91dGUocGF0aCkge1xuICB2YXIgcm91dGUgPSBuZXcgUm91dGUocGF0aCk7XG5cbiAgdmFyIGxheWVyID0gbmV3IExheWVyKHBhdGgsIHtcbiAgICBzZW5zaXRpdmU6IHRoaXMuY2FzZVNlbnNpdGl2ZSxcbiAgICBzdHJpY3Q6IHRoaXMuc3RyaWN0LFxuICAgIGVuZDogdHJ1ZVxuICB9LCByb3V0ZS5kaXNwYXRjaC5iaW5kKHJvdXRlKSk7XG5cbiAgbGF5ZXIucm91dGUgPSByb3V0ZTtcblxuICB0aGlzLnN0YWNrLnB1c2gobGF5ZXIpO1xuICByZXR1cm4gcm91dGU7XG59O1xuXG4vLyBjcmVhdGUgUm91dGVyI1ZFUkIgZnVuY3Rpb25zXG5tZXRob2RzLmNvbmNhdCgnYWxsJykuZm9yRWFjaChmdW5jdGlvbihtZXRob2Qpe1xuICBwcm90b1ttZXRob2RdID0gZnVuY3Rpb24ocGF0aCl7XG4gICAgdmFyIHJvdXRlID0gdGhpcy5yb3V0ZShwYXRoKVxuICAgIHJvdXRlW21ldGhvZF0uYXBwbHkocm91dGUsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG59KTtcblxuLy8gYXBwZW5kIG1ldGhvZHMgdG8gYSBsaXN0IG9mIG1ldGhvZHNcbmZ1bmN0aW9uIGFwcGVuZE1ldGhvZHMobGlzdCwgYWRkaXRpb24pIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhZGRpdGlvbi5sZW5ndGg7IGkrKykge1xuICAgIHZhciBtZXRob2QgPSBhZGRpdGlvbltpXTtcbiAgICBpZiAobGlzdC5pbmRleE9mKG1ldGhvZCkgPT09IC0xKSB7XG4gICAgICBsaXN0LnB1c2gobWV0aG9kKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gZ2V0IHBhdGhuYW1lIG9mIHJlcXVlc3RcbmZ1bmN0aW9uIGdldFBhdGhuYW1lKHJlcSkge1xuICB0cnkge1xuICAgIHJldHVybiBwYXJzZVVybChyZXEpLnBhdGhuYW1lO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8vIEdldCBnZXQgcHJvdG9jb2wgKyBob3N0IGZvciBhIFVSTFxuZnVuY3Rpb24gZ2V0UHJvdG9ob3N0KHVybCkge1xuICBpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycgfHwgdXJsLmxlbmd0aCA9PT0gMCB8fCB1cmxbMF0gPT09ICcvJykge1xuICAgIHJldHVybiB1bmRlZmluZWRcbiAgfVxuXG4gIHZhciBzZWFyY2hJbmRleCA9IHVybC5pbmRleE9mKCc/JylcbiAgdmFyIHBhdGhMZW5ndGggPSBzZWFyY2hJbmRleCAhPT0gLTFcbiAgICA/IHNlYXJjaEluZGV4XG4gICAgOiB1cmwubGVuZ3RoXG4gIHZhciBmcWRuSW5kZXggPSB1cmwuc2xpY2UoMCwgcGF0aExlbmd0aCkuaW5kZXhPZignOi8vJylcblxuICByZXR1cm4gZnFkbkluZGV4ICE9PSAtMVxuICAgID8gdXJsLnN1YnN0cmluZygwLCB1cmwuaW5kZXhPZignLycsIDMgKyBmcWRuSW5kZXgpKVxuICAgIDogdW5kZWZpbmVkXG59XG5cbi8vIGdldCB0eXBlIGZvciBlcnJvciBtZXNzYWdlXG5mdW5jdGlvbiBnZXR0eXBlKG9iaikge1xuICB2YXIgdHlwZSA9IHR5cGVvZiBvYmo7XG5cbiAgaWYgKHR5cGUgIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cblxuICAvLyBpbnNwZWN0IFtbQ2xhc3NdXSBmb3Igb2JqZWN0c1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopXG4gICAgLnJlcGxhY2Uob2JqZWN0UmVnRXhwLCAnJDEnKTtcbn1cblxuLyoqXG4gKiBNYXRjaCBwYXRoIHRvIGEgbGF5ZXIuXG4gKlxuICogQHBhcmFtIHtMYXllcn0gbGF5ZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXG4gKiBAcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIG1hdGNoTGF5ZXIobGF5ZXIsIHBhdGgpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gbGF5ZXIubWF0Y2gocGF0aCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiBlcnI7XG4gIH1cbn1cblxuLy8gbWVyZ2UgcGFyYW1zIHdpdGggcGFyZW50IHBhcmFtc1xuZnVuY3Rpb24gbWVyZ2VQYXJhbXMocGFyYW1zLCBwYXJlbnQpIHtcbiAgaWYgKHR5cGVvZiBwYXJlbnQgIT09ICdvYmplY3QnIHx8ICFwYXJlbnQpIHtcbiAgICByZXR1cm4gcGFyYW1zO1xuICB9XG5cbiAgLy8gbWFrZSBjb3B5IG9mIHBhcmVudCBmb3IgYmFzZVxuICB2YXIgb2JqID0gbWl4aW4oe30sIHBhcmVudCk7XG5cbiAgLy8gc2ltcGxlIG5vbi1udW1lcmljIG1lcmdpbmdcbiAgaWYgKCEoMCBpbiBwYXJhbXMpIHx8ICEoMCBpbiBwYXJlbnQpKSB7XG4gICAgcmV0dXJuIG1peGluKG9iaiwgcGFyYW1zKTtcbiAgfVxuXG4gIHZhciBpID0gMDtcbiAgdmFyIG8gPSAwO1xuXG4gIC8vIGRldGVybWluZSBudW1lcmljIGdhcHNcbiAgd2hpbGUgKGkgaW4gcGFyYW1zKSB7XG4gICAgaSsrO1xuICB9XG5cbiAgd2hpbGUgKG8gaW4gcGFyZW50KSB7XG4gICAgbysrO1xuICB9XG5cbiAgLy8gb2Zmc2V0IG51bWVyaWMgaW5kaWNlcyBpbiBwYXJhbXMgYmVmb3JlIG1lcmdlXG4gIGZvciAoaS0tOyBpID49IDA7IGktLSkge1xuICAgIHBhcmFtc1tpICsgb10gPSBwYXJhbXNbaV07XG5cbiAgICAvLyBjcmVhdGUgaG9sZXMgZm9yIHRoZSBtZXJnZSB3aGVuIG5lY2Vzc2FyeVxuICAgIGlmIChpIDwgbykge1xuICAgICAgZGVsZXRlIHBhcmFtc1tpXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWl4aW4ob2JqLCBwYXJhbXMpO1xufVxuXG4vLyByZXN0b3JlIG9iaiBwcm9wcyBhZnRlciBmdW5jdGlvblxuZnVuY3Rpb24gcmVzdG9yZShmbiwgb2JqKSB7XG4gIHZhciBwcm9wcyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMik7XG4gIHZhciB2YWxzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAyKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgcHJvcHNbaV0gPSBhcmd1bWVudHNbaSArIDJdO1xuICAgIHZhbHNbaV0gPSBvYmpbcHJvcHNbaV1dO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAvLyByZXN0b3JlIHZhbHNcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBvYmpbcHJvcHNbaV1dID0gdmFsc1tpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcbn1cblxuLy8gc2VuZCBhbiBPUFRJT05TIHJlc3BvbnNlXG5mdW5jdGlvbiBzZW5kT3B0aW9uc1Jlc3BvbnNlKHJlcywgb3B0aW9ucywgbmV4dCkge1xuICB0cnkge1xuICAgIHZhciBib2R5ID0gb3B0aW9ucy5qb2luKCcsJyk7XG4gICAgcmVzLnNldCgnQWxsb3cnLCBib2R5KTtcbiAgICByZXMuc2VuZChib2R5KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbmV4dChlcnIpO1xuICB9XG59XG5cbi8vIHdyYXAgYSBmdW5jdGlvblxuZnVuY3Rpb24gd3JhcChvbGQsIGZuKSB7XG4gIHJldHVybiBmdW5jdGlvbiBwcm94eSgpIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoICsgMSk7XG5cbiAgICBhcmdzWzBdID0gb2xkO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGFyZ3NbaSArIDFdID0gYXJndW1lbnRz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