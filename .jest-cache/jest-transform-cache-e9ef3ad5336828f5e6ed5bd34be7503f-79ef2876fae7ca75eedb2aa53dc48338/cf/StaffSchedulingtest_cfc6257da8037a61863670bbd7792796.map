{"version":3,"names":["_getJestObj","mock","jest","requireActual","useSocket","socket","on","fn","off","emit","updateSchedule","_interopRequireDefault","require","_react","_react2","_reactRouterDom","_AuthContext","_SocketContext","_StaffScheduling","_axios","_jsxRuntime","describe","mockSchedules","id","staffId","staffName","shiftType","department","startTime","endTime","notes","renderComponent","role","mockUser","render","jsx","MemoryRouter","children","AuthProvider","value","user","hasRole","SocketProvider","default","beforeEach","clearAllMocks","axios","get","mockResolvedValue","data","it","expect","screen","getByText","toBeInTheDocument","waitFor","toHaveBeenCalledWith","newSchedule","post","mockResolvedValueOnce","addButton","findByText","fireEvent","click","staffIdInput","getByLabelText","departmentInput","notesInput","change","target","saveButton","toHaveBeenCalled","scheduleCard","closest","put","deleteButton","delete","mockRejectedValueOnce","Error","rerender","updatedSchedule","queryByText","not"],"sources":["StaffScheduling.test.js"],"sourcesContent":["import React from 'react';\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport { MemoryRouter } from 'react-router-dom';\nimport { AuthProvider } from '../../context/AuthContext';\nimport { SocketProvider } from '../../context/SocketContext';\nimport StaffScheduling from '../../pages/StaffScheduling';\nimport axios from 'axios';\n\n// Mock the modules\njest.mock('axios');\njest.mock('../../context/SocketContext', () => ({\n  ...jest.requireActual('../../context/SocketContext'),\n  useSocket: () => ({\n    socket: {\n      on: jest.fn(),\n      off: jest.fn(),\n      emit: jest.fn()\n    },\n    updateSchedule: jest.fn()\n  })\n}));\n\ndescribe('StaffScheduling Component', () => {\n  const mockSchedules = [\n    {\n      id: 'schedule-1',\n      staffId: 'staff-1',\n      staffName: 'Dr. Smith',\n      shiftType: 'regular',\n      department: 'Cardiology',\n      startTime: '2024-03-01T09:00:00Z',\n      endTime: '2024-03-01T17:00:00Z',\n      notes: 'Morning shift'\n    },\n    {\n      id: 'schedule-2',\n      staffId: 'staff-2',\n      staffName: 'Dr. Johnson',\n      shiftType: 'on-call',\n      department: 'Emergency',\n      startTime: '2024-03-01T17:00:00Z',\n      endTime: '2024-03-02T09:00:00Z',\n      notes: 'Night shift'\n    }\n  ];\n\n  const renderComponent = (role = 'admin') => {\n    const mockUser = {\n      id: 'user-1',\n      role: role\n    };\n\n    return render(\n      <MemoryRouter>\n        <AuthProvider value={{ user: mockUser, hasRole: () => role === 'admin' || role === 'staff' }}>\n          <SocketProvider>\n            <StaffScheduling />\n          </SocketProvider>\n        </AuthProvider>\n      </MemoryRouter>\n    );\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    axios.get.mockResolvedValue({ data: mockSchedules });\n  });\n\n  it('renders access denied for unauthorized users', () => {\n    renderComponent('patient');\n    expect(screen.getByText('Access Denied')).toBeInTheDocument();\n  });\n\n  it('loads and displays staff schedules', async () => {\n    renderComponent();\n\n    await waitFor(() => {\n      expect(axios.get).toHaveBeenCalledWith('/api/staff-schedules');\n    });\n\n    expect(screen.getByText('Staff Scheduling')).toBeInTheDocument();\n    expect(screen.getByText('Dr. Smith')).toBeInTheDocument();\n    expect(screen.getByText('Dr. Johnson')).toBeInTheDocument();\n  });\n\n  it('allows admin to add new schedule', async () => {\n    renderComponent();\n\n    const newSchedule = {\n      id: 'schedule-3',\n      staffId: 'staff-3',\n      staffName: 'Dr. Brown',\n      shiftType: 'regular',\n      department: 'Pediatrics',\n      startTime: '2024-03-02T09:00:00Z',\n      endTime: '2024-03-02T17:00:00Z',\n      notes: 'Morning shift'\n    };\n\n    axios.post.mockResolvedValueOnce({ data: newSchedule });\n\n    // Click add schedule button\n    const addButton = await screen.findByText('Add Schedule');\n    fireEvent.click(addButton);\n\n    // Fill out the form\n    const staffIdInput = screen.getByLabelText(/Staff Member/i);\n    const departmentInput = screen.getByLabelText(/Department/i);\n    const notesInput = screen.getByLabelText(/Notes/i);\n\n    fireEvent.change(staffIdInput, { target: { value: 'staff-3' } });\n    fireEvent.change(departmentInput, { target: { value: 'Pediatrics' } });\n    fireEvent.change(notesInput, { target: { value: 'Morning shift' } });\n\n    // Submit the form\n    const saveButton = screen.getByText('Save');\n    fireEvent.click(saveButton);\n\n    await waitFor(() => {\n      expect(axios.post).toHaveBeenCalled();\n    });\n  });\n\n  it('allows admin to edit schedule', async () => {\n    renderComponent();\n\n    await waitFor(() => {\n      expect(screen.getByText('Dr. Smith')).toBeInTheDocument();\n    });\n\n    // Click on a schedule to edit\n    const scheduleCard = screen.getByText('Dr. Smith').closest('div');\n    fireEvent.click(scheduleCard);\n\n    // Update the notes\n    const notesInput = screen.getByLabelText(/Notes/i);\n    fireEvent.change(notesInput, { target: { value: 'Updated shift notes' } });\n\n    // Save the changes\n    const saveButton = screen.getByText('Save');\n    fireEvent.click(saveButton);\n\n    await waitFor(() => {\n      expect(axios.put).toHaveBeenCalled();\n    });\n  });\n\n  it('allows admin to delete schedule', async () => {\n    renderComponent();\n\n    await waitFor(() => {\n      expect(screen.getByText('Dr. Smith')).toBeInTheDocument();\n    });\n\n    // Click on a schedule to edit\n    const scheduleCard = screen.getByText('Dr. Smith').closest('div');\n    fireEvent.click(scheduleCard);\n\n    // Click delete button\n    const deleteButton = screen.getByText('Delete');\n    fireEvent.click(deleteButton);\n\n    await waitFor(() => {\n      expect(axios.delete).toHaveBeenCalledWith('/api/staff-schedules/schedule-1');\n    });\n  });\n\n  it('handles error states', async () => {\n    axios.get.mockRejectedValueOnce(new Error('Failed to load schedules'));\n    renderComponent();\n\n    await waitFor(() => {\n      expect(screen.getByText('Failed to load schedules')).toBeInTheDocument();\n    });\n  });\n\n  it('updates schedule display when receiving WebSocket events', async () => {\n    const { rerender } = renderComponent();\n\n    await waitFor(() => {\n      expect(screen.getByText('Dr. Smith')).toBeInTheDocument();\n    });\n\n    // Simulate receiving a WebSocket update\n    const updatedSchedule = {\n      ...mockSchedules[0],\n      notes: 'Updated via WebSocket'\n    };\n\n    axios.get.mockResolvedValueOnce({ data: [updatedSchedule, mockSchedules[1]] });\n    rerender(\n      <MemoryRouter>\n        <AuthProvider value={{ user: { id: 'user-1', role: 'admin' }, hasRole: () => true }}>\n          <SocketProvider>\n            <StaffScheduling />\n          </SocketProvider>\n        </AuthProvider>\n      </MemoryRouter>\n    );\n\n    await waitFor(() => {\n      expect(screen.getByText('Updated via WebSocket')).toBeInTheDocument();\n    });\n  });\n\n  it('restricts edit/delete actions for non-admin users', async () => {\n    renderComponent('staff');\n\n    await waitFor(() => {\n      expect(screen.getByText('Dr. Smith')).toBeInTheDocument();\n    });\n\n    expect(screen.queryByText('Add Schedule')).not.toBeInTheDocument();\n    expect(screen.queryByText('Delete')).not.toBeInTheDocument();\n  });\n\n  it('renders the Staff Scheduling page', () => {\n    render(<StaffScheduling />);\n    expect(screen.getByText('Staff Scheduling')).toBeInTheDocument();\n    expect(screen.getByText('Welcome to the Staff Scheduling page.')).toBeInTheDocument();\n  });\n}); "],"mappings":"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","ignoreList":[]}