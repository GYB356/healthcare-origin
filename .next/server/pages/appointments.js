(()=>{var e={};e.id=883,e.ids=[883,660],e.modules={3472:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Z:()=>x});var a=s(8416),i=s.n(a),n=s(6689),l=s(5641),o=s(3590),d=s(8248),c=s(997),u=e([l,o,d]);function m(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function p(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?m(Object(s),!0).forEach(function(t){i()(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function x({appointment:e,onSubmit:t,onCancel:s}){let{0:r,1:a}=(0,n.useState)([]),{0:i,1:u}=(0,n.useState)([]),{0:m,1:x}=(0,n.useState)(!1),{register:h,handleSubmit:f,watch:b,formState:{errors:g},setValue:y}=(0,l.useForm)({defaultValues:e||{title:"",notes:"",date:(0,d.format)(new Date,"yyyy-MM-dd"),startTime:"09:00",endTime:"10:00",isVirtual:!1,status:"SCHEDULED"}}),j=b("isVirtual");(0,n.useEffect)(()=>{v()},[]);let v=async()=>{try{let e=await fetch("/api/users?role=DOCTOR");if(!e.ok)throw Error("Failed to fetch doctors");let t=await e.json();a(t);let s=await fetch("/api/users?role=PATIENT");if(!s.ok)throw Error("Failed to fetch patients");let r=await s.json();u(r)}catch(e){console.error("Error fetching users:",e),o.toast.error("Failed to load users")}},w=async e=>{try{x(!0),await t(e),o.toast.success("Appointment saved successfully")}catch(e){console.error("Error saving appointment:",e),o.toast.error("Failed to save appointment")}finally{x(!1)}};return(0,c.jsxs)("form",{onSubmit:f(w),className:"space-y-6",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),c.jsx("input",p(p({type:"text",id:"title"},h("title",{required:"Title is required"})),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})),g.title&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.title.message})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700",children:"Date"}),c.jsx("input",p(p({type:"date",id:"date"},h("date",{required:"Date is required"})),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})),g.date&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.date.message})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,c.jsxs)("select",p(p({id:"status"},h("status")),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[c.jsx("option",{value:"SCHEDULED",children:"Scheduled"}),c.jsx("option",{value:"COMPLETED",children:"Completed"}),c.jsx("option",{value:"CANCELLED",children:"Cancelled"}),c.jsx("option",{value:"RESCHEDULED",children:"Rescheduled"})]}))]})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"startTime",className:"block text-sm font-medium text-gray-700",children:"Start Time"}),c.jsx("input",p(p({type:"time",id:"startTime"},h("startTime",{required:"Start time is required"})),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})),g.startTime&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.startTime.message})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"endTime",className:"block text-sm font-medium text-gray-700",children:"End Time"}),c.jsx("input",p(p({type:"time",id:"endTime"},h("endTime",{required:"End time is required"})),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})),g.endTime&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.endTime.message})]})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"doctorId",className:"block text-sm font-medium text-gray-700",children:"Doctor"}),(0,c.jsxs)("select",p(p({id:"doctorId"},h("doctorId",{required:"Doctor is required"})),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select a doctor"}),r.map(e=>(0,c.jsxs)("option",{value:e.id,children:["Dr. ",e.name]},e.id))]})),g.doctorId&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.doctorId.message})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"patientId",className:"block text-sm font-medium text-gray-700",children:"Patient"}),(0,c.jsxs)("select",p(p({id:"patientId"},h("patientId",{required:"Patient is required"})),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select a patient"}),i.map(e=>c.jsx("option",{value:e.id,children:e.name},e.id))]})),g.patientId&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.patientId.message})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center",children:[c.jsx("input",p(p({type:"checkbox",id:"isVirtual"},h("isVirtual")),{},{className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"})),c.jsx("label",{htmlFor:"isVirtual",className:"ml-2 block text-sm text-gray-700",children:"Virtual Appointment"})]}),j&&(0,c.jsxs)("div",{className:"mt-4",children:[c.jsx("label",{htmlFor:"virtualLink",className:"block text-sm font-medium text-gray-700",children:"Virtual Meeting Link"}),c.jsx("input",p(p({type:"url",id:"virtualLink"},h("virtualLink",{required:!!j&&"Virtual meeting link is required",pattern:{value:/^https?:\/\/.+/i,message:"Please enter a valid URL"}})),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"https://meet.example.com/room"})),g.virtualLink&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.virtualLink.message})]})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),c.jsx("textarea",p(p({id:"notes",rows:3},h("notes")),{},{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}))]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:m?"Saving...":"Save"})]})]})}[l,o,d]=u.then?(await u)():u,r()}catch(e){r(e)}})},3389:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Z:()=>c});var a=s(6689),i=s(1185),n=s(467),l=s(3472),o=s(997),d=e([i,n,l]);function c({isOpen:e,onClose:t,appointment:s,onSubmit:r,title:d}){return o.jsx(i.Transition.Root,{show:e,as:a.Fragment,children:(0,o.jsxs)(i.Dialog,{as:"div",className:"relative z-50",onClose:t,children:[o.jsx(i.Transition.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:o.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),o.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:o.jsx("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:o.jsx(i.Transition.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,o.jsxs)(i.Dialog.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl sm:p-6",children:[o.jsx("div",{className:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block",children:(0,o.jsxs)("button",{type:"button",className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:t,children:[o.jsx("span",{className:"sr-only",children:"Close"}),o.jsx(n.XMarkIcon,{className:"h-6 w-6","aria-hidden":"true"})]})}),o.jsx("div",{className:"sm:flex sm:items-start",children:(0,o.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[o.jsx(i.Dialog.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900 mb-6",children:d}),o.jsx("div",{className:"mt-2",children:o.jsx(l.Z,{appointment:s,onSubmit:r,onCancel:t})})]})})]})})})})]})})}[i,n,l]=d.then?(await d)():d,r()}catch(e){r(e)}})},3306:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Z:()=>p});var a=s(6689),i=s(9870),n=s(5503),l=s(476),o=s(1103),d=s(1649),c=s(3590),u=s(997),m=e([i,n,l,o,c]);function p({onEventClick:e,onSelectSlot:t,doctorId:s,patientId:r}){let{data:m}=(0,d.useSession)(),{0:p,1:f}=(0,a.useState)([]),{0:b,1:g}=(0,a.useState)(!0);(0,a.useEffect)(()=>{y()},[s,r]);let y=async()=>{try{let e="/api/appointments",t=new URLSearchParams;s&&t.append("doctorId",s),r&&t.append("patientId",r),t.toString()&&(e+=`?${t.toString()}`);let a=await fetch(e);if(!a.ok)throw Error("Failed to fetch appointments");let i=await a.json();f(i)}catch(e){console.error("Error fetching appointments:",e),c.toast.error("Failed to load appointments")}finally{g(!1)}},j=p.map(e=>({id:e.id,title:e.title,start:new Date(`${e.date}T${e.startTime}`),end:new Date(`${e.date}T${e.endTime}`),backgroundColor:h(e.status),borderColor:h(e.status),extendedProps:{isVirtual:e.isVirtual,status:e.status,patient:e.patient,doctor:e.doctor}}));return u.jsx("div",{className:"h-full bg-white rounded-lg shadow p-4",children:u.jsx(i.default,{plugins:[n.default,l.default,o.default],initialView:"timeGridWeek",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},events:j,eventClick:t=>{let s=p.find(e=>e.id===t.event.id);s&&e&&e(s)},select:e=>{t&&t(e.start,e.end)},selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!0,allDaySlot:!1,slotMinTime:"08:00:00",slotMaxTime:"20:00:00",height:"auto",expandRows:!0,stickyHeaderDates:!0,nowIndicator:!0,eventContent:x,loading:e=>g(e)})})}function x(e){let{isVirtual:t,patient:s,doctor:r}=e.event.extendedProps;return(0,u.jsxs)("div",{className:"p-1 overflow-hidden",children:[u.jsx("div",{className:"font-semibold text-sm truncate",children:e.event.title}),(0,u.jsxs)("div",{className:"text-xs truncate",children:[t&&"\uD83C\uDFA5 ",s?.name," with Dr. ",r?.name]})]})}function h(e){switch(e.toUpperCase()){case"SCHEDULED":return"#3B82F6";case"COMPLETED":return"#10B981";case"CANCELLED":return"#EF4444";case"RESCHEDULED":return"#F59E0B";default:return"#6B7280"}}[i,n,l,o,c]=m.then?(await m)():m,r()}catch(e){r(e)}})},6353:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>p});var a=s(8416),i=s.n(a),n=s(215),l=s.n(n),o=s(1649),d=s(3590);s(8819),s(6764);var c=s(997),u=e([d]);d=(u.then?(await u)():u)[0];let x=["session"];function m(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function p(e){let{Component:t,pageProps:{session:s}}=e,r=l()(e.pageProps,x);return(0,c.jsxs)(o.SessionProvider,{session:s,children:[c.jsx(d.ToastContainer,{position:"top-right"}),c.jsx(t,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?m(Object(s),!0).forEach(function(t){i()(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},r))]})}r()}catch(e){r(e)}})},6037:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>m});var a=s(6689),i=s(1649),n=s(3590),l=s(3306),o=s(3389),d=s(3524),c=s(997),u=e([n,l,o]);function m(){let{data:e}=(0,i.useSession)(),{0:t,1:s}=(0,a.useState)(!1),{0:r,1:u}=(0,a.useState)(null),{0:m,1:p}=(0,a.useState)(null),x=async e=>{try{let t=r?`/api/appointments/${r.id}`:"/api/appointments",a=await fetch(t,{method:r?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to save appointment")}s(!1),u(null),p(null),n.toast.success(`Appointment ${r?"updated":"created"} successfully`)}catch(e){n.toast.error(e.message)}};return c.jsx("div",{className:"min-h-screen bg-gray-100 py-8",children:(0,c.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,c.jsxs)("div",{className:"md:flex md:items-center md:justify-between mb-8",children:[c.jsx("div",{className:"flex-1 min-w-0",children:c.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Appointments"})}),e?.user?.role&&[d.UserRole.STAFF,d.UserRole.ADMIN,d.UserRole.DOCTOR].includes(e.user.role)&&c.jsx("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:c.jsx("button",{type:"button",onClick:()=>{u(null),p(null),s(!0)},className:"ml-3 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create Appointment"})})]}),c.jsx("div",{className:"bg-white rounded-lg shadow",children:c.jsx(l.Z,{onEventClick:e=>{u(e),s(!0)},onSelectSlot:(t,r)=>{if(!e?.user?.role||![d.UserRole.STAFF,d.UserRole.ADMIN,d.UserRole.DOCTOR].includes(e.user.role)){n.toast.error("You do not have permission to create appointments");return}p({start:t,end:r}),u(null),s(!0)},doctorId:e?.user?.role===d.UserRole.DOCTOR?e.user.id:void 0,patientId:e?.user?.role===d.UserRole.PATIENT?e.user.id:void 0})}),c.jsx(o.Z,{isOpen:t,onClose:()=>{s(!1),u(null),p(null)},appointment:r||(m?{date:m.start.toISOString().split("T")[0],startTime:m.start.toTimeString().slice(0,5),endTime:m.end.toTimeString().slice(0,5),status:"SCHEDULED",isVirtual:!1}:null),onSubmit:x,title:r?"Edit Appointment":"Create Appointment"})]})})}[n,l,o]=u.then?(await u)():u,r()}catch(e){r(e)}})},1323:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},6953:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>f,default:()=>m,getServerSideProps:()=>h,getStaticPaths:()=>x,getStaticProps:()=>p,reportWebVitals:()=>b,routeModule:()=>S,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>g});var a=s(7093),i=s(5244),n=s(1323),l=s(4516),o=s.n(l),d=s(6353),c=s(6037),u=e([d,c]);[d,c]=u.then?(await u)():u;let m=(0,n.l)(c,"default"),p=(0,n.l)(c,"getStaticProps"),x=(0,n.l)(c,"getStaticPaths"),h=(0,n.l)(c,"getServerSideProps"),f=(0,n.l)(c,"config"),b=(0,n.l)(c,"reportWebVitals"),g=(0,n.l)(c,"unstable_getStaticProps"),y=(0,n.l)(c,"unstable_getStaticPaths"),j=(0,n.l)(c,"unstable_getStaticParams"),v=(0,n.l)(c,"unstable_getServerProps"),w=(0,n.l)(c,"unstable_getServerSideProps"),S=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/appointments",pathname:"/appointments",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:c});r()}catch(e){r(e)}})},8819:()=>{},6764:()=>{},5244:(e,t)=>{"use strict";var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},3524:e=>{"use strict";e.exports=require("@prisma/client")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},5503:e=>{"use strict";e.exports=import("@fullcalendar/daygrid")},1103:e=>{"use strict";e.exports=import("@fullcalendar/interaction")},9870:e=>{"use strict";e.exports=import("@fullcalendar/react")},476:e=>{"use strict";e.exports=import("@fullcalendar/timegrid")},1185:e=>{"use strict";e.exports=import("@headlessui/react")},467:e=>{"use strict";e.exports=import("@heroicons/react/24/outline")},8248:e=>{"use strict";e.exports=import("date-fns")},5641:e=>{"use strict";e.exports=import("react-hook-form")},3590:e=>{"use strict";e.exports=import("react-toastify")},1017:e=>{"use strict";e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[516],()=>s(6953));module.exports=r})();